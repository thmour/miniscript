<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>m.js</title>
    <link rel="stylesheet" href="css/style.css" media="screen" type="text/css" />
    <link type="text/css" rel="stylesheet" href="css/shCoreMjs.css" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
</head>
<body>
    <div id="bar">
        <table>
            <tr>
                <td>
                    <span id="logo">
                        <span id="m">m</span><span>.js</span>
                    </span>
                </td>
                <td>
                    <div id='cssmenu'>
                        <ul>
                            <li><a href='#'><span>Try</span></a></li>
                            <li><a href='#'><span>Documentation</span></a></li>
                            <li class='last'><a href='https://github.com/thmour/m.js' target="_blank"><span>View on Github</span></a></li>
                        </ul>
                    </div>
                </td>
            </tr>
        </table>
    </div>
    <span id="bug"></span>
    <p>
        <span class='header'>What?</span><br><br>
        m.js is a minimal dialect of javascript. It inherits every good part of Python, Ruby and C++. You can compile the code to javascript or run it directly from the console.
    </p>
    <p>
        <span class='header'>Why?</span><br><br>
        It is semicolon free, indent independent, DRY, readable and easy to learn. At the end, it's all javascript!
    </p>
    <p>
        <span class='header'>Install:</span><br><br>
        You can install the m.js compiler using the following command:
    </p>
    <p class="command">$ npm install m.js -g</p>
    <p>
        then you can either run your script, or output the javascript file:
    </p>
    <p class="command">
        $ mjs run myscript[.mjs]<br>
        $ mjs out myscript[.mjs] [output_name[.js]]
    </p>
    <p class="middle">
        <span class='header'>Let's start!</span><br><br>
        Below is your first hello world program:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            print 'Hello World', '!'
        </pre>
        <pre class="brush: mjs;">
            console.log('Hello World', '!');
        </pre>
    </code>
    <p class="middle">
        As you see it resembles python, how about functions?
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            foo = # bar, baz {
                print bar, baz
            }
            &nbsp;
        </pre>
        <pre class="brush: js;">
            var foo;
            foo = function(bar, baz) {
                console.log(bar, baz);
            };
        </pre>
    </code>
    <p class="middle">
        You can't define a function as it is. It must be assigned to a variable.
        It is possible to give a name to a function, achieving recursion on anonymous functions.
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            print # fib : n {
                if n == 0 or n == 1
                    return n
                else
                    return fib(n-1) + fib(n-2)
                ;
            }(8)
        </pre>
        <pre class="brush: js;">
            console.log((function fib(n) {
                if (n == 0 || n == 1) {
                    return n;
                } else {
                    return fib(n - 1) + fib(n - 2);
                }
            })(8));
        </pre>
    </code>
    <p class="middle">
        As you saw many things are considered obvious and have been removed from m.js grammar like parentheses and code blocks.
        Next stop, assignments:
    </p>
    <code class="block">
        <pre class="brush: mjs;">                     
            x = 5
            y = 6

            a, b = [x,y]

            a += 5

            x = y = a
        </pre>
        <pre class="brush: js;">
            var x, y, a, b;
            x = 5;
            y = 6;
            _c = [x, y];
            a = _c[0];
            b = _c[1];
            a += 5;
            x = y = a;
        </pre>
    </code>
    <p class="middle">
        This is what you can only do with asignments (for now). Let's continue with a full if statement:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            a = 5

            if a < 1
                print 'a is less than 1'
            elif a < 4
                print 'a is less than 4'
            else
                print 'a is greater than or equal to 4'
            ;
        </pre>
        <pre class="brush: js;">
            var a;
            a = 5;
            if (a < 1) {
                console.log('a is less than 1');
            } else if (a < 4) {
                console.log('a is less than 4');
            } else {
                console.log('a is greater than or equal to 4');
            }
        </pre>
    </code>
    <p class="middle">
        Only a ';' is required to finish an if statement, the same goes for other statements containing code blocks.
        Variables start with lowercase letter while classes start with uppercase one. About time for a switch statement:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            switch john.likes
	            case 'basket', 'football'
		            send_message(john, 'What team you support?')
	            case 'squash'
		            send_message(john, 'I don\'t know much about it')
	            default
		            send_message(john, 'Whatever...')
            ;
            &nbsp;
            &nbsp;
            &nbsp;
        </pre>
        <pre class="brush: js;">
            switch (john.likes) {
                case 'basket':
                case 'football':
                    send_message(john, 'What team you support?');
                    break;
                case 'squash':
                    send_message(john, 'I don\'t know much about it');
                    break;
                default:
                    send_message(john, 'Whatever...');
            }
        </pre>
    </code>
    <p class="middle">
        Pretty neat, huh? At least m.js tries to keep it simple and elegant.
        Now we can check out some for loops:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            obj = { a=1 b=2 c=3 }

            db = [{ user='peter' age=21 },
                  { user='john'  age=32 },
                  { user='ralph' age=27 }]

            for i of 1..5
	            print i
            ;

            for key in obj
	            print key + ':', obj[key]
            ;

            String::capitalize = # {
                return this:0.toUpperCase() + this.slice(1)
            }

            for user, age in db
                print "%user.capitalize() is %{age + 1} years old"
            ;
            &nbsp;
            &nbsp;
        </pre>
        <pre class="brush: js;">
            var obj, db, i, key, user, age, _i, _l;
            obj = { a: 1, b: 2, c: 3 };
            db = [{user: 'peter', age: 21},
                  {user: 'john' , age: 32},
                  {user: 'ralph', age: 27}];

            for (i = 0; ++i <= 5;) {
                console.log(i);
            }

            for (key in obj) {
                console.log(key + ':', obj[key]);
            }

            String.prototype.capitalize = function() {
                return this[0].toUpperCase() + this.slice(1);
            };

            for (_i = -1, _l = db.length; ++_i < _l;) {
                user = db[_i].user;
                age = db[_i].age;
                console.log(user.capitalize() + " is " + (age + 1) + " years old");
            }
        </pre>
    </code>
    <p class="middle">
        You see that the for in behaves different when there are more than one iterators.
        This is more useful than splitting every member of an object into 2 variables. 
        Now we proceed to classes. Here is the first example:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            class Animal
    	        group, colors, legs
            ;

            class Dog : Animal
	            @name, colors, @breed {
		            super('mammal', colors, 4)
	            }
            ;

            Dog::pet = # {
	            print 'wuf wuf!'
            }

            my_dog = new Dog('frisky', ['brown', 'white'], 'corgi')

            my_dog.pet()    
        </pre>
        <pre class="brush: js;">
            var my_dog;
            function Animal(group, colors, legs) {
                this.group = group;
                this.colors = colors;
                this.legs = legs;
            }
            function Dog(name, colors, breed) {
                Animal.call(this, 'mammal', colors, 4);
                this.name = name;
                this.breed = breed;
            }
            Dog.prototype = Object.create(Animal.prototype);
            Dog.prototype.pet = function() {
                console.log('wuf wuf!');
            };
            my_dog = new Dog('frisky', ['brown', 'white'], 'corgi');
            my_dog.pet();
        </pre>
    </code>
    <p class="middle">
        Right after the class and its name, you can define the constructor with optional arguments and body.
        Optional body generates "this.member = meber" code and "super" if needed. Then we proceed to class scope:
    </p>
    <code class="block">
        <pre class="brush: mjs;">
            class Character
                name, health, attack, defense
                
              public
                getGold = # {
                    return gold
                }
                setGold = # value {
                    gold = value
                }
                levelUp = # {
                    level++
                }

              private
                gold = 0
                level = 0
            ;

            Character::lootGold = # amount {
                print char.gold //undefined
                @setGold(@getGold() + amount)
            }

            char = new Character('Vollkorn', 150, 7, 3)

            char.lootGold(50)

            print char.getGold() //50 
        </pre>
        <pre class="brush: js;">
            var char;
            function Character(name, health, attack, defense) {
                var gold = 0,
                    level = 0;
                this.getGold = function() {
                    return gold;
                };
                this.setGold = function(value) {
                    gold = value;
                };
                this.levelUp = function() {
                    level++;
                };
                this.name = name;
                this.health = health;
                this.attack = attack;
                this.defense = defense;
            }

            Character.prototype.lootGold = function(amount) {
                console.log(char.gold);
                this.setGold(this.getGold() + amount);
            };

            char = new Character('Vollkorn', 150, 7, 3);

            char.lootGold(50);

            console.log(char.getGold());
        </pre>
    </code>
    <script type="text/javascript" src="scripts/shCore.js"></script>
    <script type="text/javascript" src="scripts/shBrushMjs.js"></script>
    <script type="text/javascript" src="scripts/shBrushJScript.js"></script>
    <script type="text/javascript">SyntaxHighlighter.all();</script>
</body>
</html>